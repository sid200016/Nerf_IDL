expname = flower_test_high_quality
basedir = ./logs
datadir = ./data/nerf_llff_data/flower
dataset_type = llff

# High resolution training (factor 4 = 2x resolution, factor 2 = 4x resolution)
factor = 4  # Reduced from 8 for higher resolution (2x more pixels)
llffhold = 8

# Increased sampling for better quality
N_rand = 2048  # Increased batch size for more stable gradients (if memory allows, else 1024)
N_samples = 128  # More coarse samples per ray (doubled from 64)
N_importance = 128  # More fine samples per ray (doubled from 64)

use_viewdirs = True
# Regularization - MINIMAL to allow maximum PE adaptation
raw_noise_std = 1e-3  # Minimal regularization (was 5e-3) - allows more PE learning

# Learnable Fourier Encoding (optimized for maximum PSNR)
learnable_pe = True

# Frequency bands - key parameter for PSNR
# Higher = more high-frequency details, but may overfit
multires = 18  # Increased from 15 for even more frequency capacity (try 15-20 range)
multires_views = 8  # Increased from 6 for better view-dependent effects (try 6-10 range)

# Fourier Encoding Hyperparameters (ULTRA-AGGRESSIVE to force proportional learning)
pe_learnable_freqs = True  # Must be True for learnable frequencies
pe_init_scale = 0.5  # Start LOWER to force adaptation
pe_lr_scale = 3.0  # MUCH HIGHER LR for PE (3x network LR) - forces high freq learning
pe_grad_amplify = 200.0  # Amplify PE gradients 200x (very aggressive - forces high freq learning)
pe_direct_update = 0.005  # Direct parameter updates to force frequency exploration (0.005 = 0.5% updates)
learnable_pe_phase = True  # Enable learnable phases

# Learning rate - increased for better PE learning
lrate = 1.5e-3  # Higher base LR to allow more PE adaptation

# Learning rate decay - MUCH slower to allow PE to keep learning
lrate_decay = 1000  # Much slower decay (was 500) - keeps PE learning longer

# Gradient clipping (disabled for maximum learning, but can enable if unstable)
grad_clip = 0.0  # No clipping for maximum learning (set to 1.0 if training becomes unstable)

# Weights & Biases logging
use_wandb = True
wandb_project = nerf-idl
wandb_run_name = flower_pe_grad200x_log_scaled


